# 조인 연산자의 종류

RDBMS와 유사한 스파크 조인 연산자

: 스파크가 제고앟는 네 가지 조인 연산자는 RDBMS 조인 연산자와 동일하게 동작 but 스파크의 조인 연산자는 Pair RDD에서만 사용 가능



- 왼쪽테이블 **<상품>**

| 상품 ID | 상품명 |
| ------- | ------ |
| 1       | 바닐라 |
| 2       | 수박   |
| 3       | 초코   |
| 6       | 포도   |



- 오른쪽테이블 **<고객 주문 상품>**

| 고객 ID | 상품 ID | 주문수량 |
| ------- | ------- | -------- |
| B       | 3       | 1        |
| D       | 1       | 2        |
| C       | 2       | 3        |
| A       | 4       | 1        |







## join = (inner join)

- 교집합 연산과 같음 ( A ∩ B ) 

- 공통적으로 존재한는 키 컬럼값을 중심으로 데이터를 조인 -> 결과 데이터 집합으로 추출



<join 결과>

| 상품 ID | 상품명 | 상품 ID | 고객 ID | 주문수량 |
| ------- | ------ | ------- | ------- | -------- |
| 1       | 바닐라 | 1       | D       | 2        |
| 2       | 수박   | 2       | C       | 3        |
| 3       | 초코   | 3       | B       | 1        |

: <상품>, <고객 주문 상품>에서 ''조인 키 컬럼 값(상품ID)''이 모두 존재하는 데이터만 출력







## leftOuterJoin

- 교집합 연산 결과와 차집합 연산 결과를 합친 것 ( (A ∩ B) ∪ (A - B) )
- 조인 키 컬럼 값이 공통적으로 존재하는 데이터와 **왼쪽**에 테이블에만 존재하는 데이터를 추출



<leftOuterJoin 결과>

| 상품 ID | 상품명 | 상품 ID | 고객 ID | 주문수량 |
| ------- | ------ | ------- | ------- | -------- |
| 1       | 바닐라 | 1       | D       | 2        |
| 2       | 수박   | 2       | C       | 3        |
| 3       | 초코   | 3       | B       | 1        |
| 5       | 포도   | (null)  | (null)  | (null)   |

: 조인 키 컬럼 값이 모두 존재하는 데이터와 왼쪽 상품테이블에만 존재하는 데이터 출력







## rightOuterJoin

- 교집합 연산 결과와 차집합 연산 결과를 합친 것 ( (A ∩ B) ∪ (B - A) )

- 조인 키 컬럼 값이 공통적으로 존재하는 데이터와 **오른쪽**에 테이블에만 존재하는 데이터를 추출



<rightOuterJoin 결과>

| 상품 ID | 상품명 | 상품 ID | 고객 ID | 주문수량 |
| ------- | ------ | ------- | ------- | -------- |
| 1       | 바닐라 | 1       | D       | 2        |
| 2       | 수박   | 2       | C       | 3        |
| 3       | 초코   | 3       | B       | 1        |
| (null)  | (null) | 4       | A       | 1        |

: 조인 키 컬럼 값이 모두 존재하는 데이터와 오른쪽 상품테이블에만 존재하는 데이터 출력







## fullOuterJoin

- 합집합 연산 결과와 같음

- 조인 키 컬럼 값 양쪽 테이블 데이터 집합과 각각 테이블에만 존재하는 모든 데이터 집합을 추출



<fullOuterJoin 결과>

| 상품 ID | 상품명 | 상품 ID | 고객 ID | 주문수량 |
| ------- | ------ | ------- | ------- | -------- |
| 1       | 바닐라 | 1       | D       | 2        |
| 2       | 수박   | 2       | C       | 3        |
| 3       | 초코   | 3       | B       | 1        |
| (null)  | (null) | 4       | A       | 1        |
| 5       | 포도   | (null)  | (null)  | (null)   |

: 양쪽 테이블의 모든 데이터 집합 출력



----

참고 링크 :  https://sparkdia.tistory.com/17

- 스파크를 다루는 기술 p137
- 2021.08.07.토
